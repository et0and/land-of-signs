Weather: Gales, thunderstorms to blast top of North Island, snow warnings for south